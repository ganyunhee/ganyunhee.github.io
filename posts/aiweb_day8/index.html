<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>[AI웹개발 취업캠프/정보통신산업진흥원(NIPA)] Day 8 - CODENAME | EUNS</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="http://ganyunhee.github.iofavicon.png">
  <link rel="canonical" href="http://ganyunhee.github.io/posts/aiweb_day8/" />
    
    
    <link rel="stylesheet" href="/css/style.min.dd27bff02027212abdfd4baaed588f9e1e864d4f574582df85cf50ce0231f297.css">
    <link rel="stylesheet" href="/assets/css/extended.min.9729f28a5087b689b946e103d96abd63bfd37b1417effa251dbf798312e3fba5.css">

  
    
    <meta property="og:title" content="[AI웹개발 취업캠프/정보통신산업진흥원(NIPA)] Day 8"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="http://ganyunhee.github.io/posts/aiweb_day8/"/>
    
    
    <meta name="twitter:card" content="summary"/>
    
    
  

  
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Fira&#43;Mono&amp;family=Inter&amp;family=Inter&#43;Tight&amp;family=Bebas&#43;Neue&amp;family=EB&#43;Garamond:ital,wght@0,400..800;1,400..800&amp;display=swap" rel="stylesheet">
  

  
</head>




<body class='page frame page-blog-single'>
  <div id="menu-main-mobile" class="menu-main-mobile">
    <ul class="menu">
        
        
            
                <li class="menu-item-home">
                    <a href="http://ganyunhee.github.io/">Home</a>
                </li>
            
        
            
                <li class="menu-item-blog">
                    <a href="http://ganyunhee.github.io/posts/">Blog</a>
                </li>
            
        
            
                <li class="menu-item-about">
                    <a href="http://ganyunhee.github.io/pages/about/">About</a>
                </li>
            
        
            
                <li class="menu-item-tags">
                    <a href="http://ganyunhee.github.io/tags/">Tags</a>
                </li>
            
        
    </ul>
</div>
  <div id="wrapper" class="wrapper">
    <div class='header'>
  <a class="header-logo" href="/">CODENAME | EUNS</a>
  <div class="menu-main">
    <ul>
      
      
      
      
      <li class="menu-item-home ">
        <a href="/">
          
          <span>Home</span>
        </a>
      </li>
      
      
      
      <li class="menu-item-blog ">
        <a href="/posts/">
          
          <span>Blog</span>
        </a>
      </li>
      
      
      
      <li class="menu-item-about ">
        <a href="/pages/about/">
          
          <span>About</span>
        </a>
      </li>
      
      
      
      <li class="menu-item-tags ">
        <a href="/tags/">
          
          <span>Tags</span>
        </a>
      </li>
      
    </ul>
  </div>
  <div id="toggle-menu-main-mobile" class="hamburger-trigger">
    <button class="hamburger">Menu</button>
  </div>
</div>
    
  <div class="blog">
    
    <div class="intro">
      <h1>[AI웹개발 취업캠프/정보통신산업진흥원(NIPA)] Day 8<span class="dot">.</span></h1>
      
    </div>
    <div class="content">
      <h1 id="과제--this-keyword">과제 &gt; <code>this</code> keyword</h1>
<h4 id="original-code">Original Code</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;홍길동&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">birthday</span><span class="o">:</span> <span class="s2">&#34;030219&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">age</span><span class="o">:</span> <span class="mi">30</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">pId</span><span class="o">:</span> <span class="s2">&#34;1234567&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fullId</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">birthday</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">pId</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">person</span><span class="p">.</span><span class="nx">fullId</span><span class="p">()</span> <span class="c1">// 0302191234567
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">person</span><span class="p">.</span><span class="nx">fullId</span><span class="p">;</span>  <span class="c1">// function () { return this.birthday + this.pId; }
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">//생성자(constructor)를 이용한 객체 생성
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">day</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span> <span class="c1">// new 연산자를 사용하여 Date 타입의 객체를 생성함.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;올해는 &#34;</span> <span class="o">+</span> <span class="nx">day</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&#34;년입니다.&#34;</span><span class="p">);</span>
</span></span></code></pre></div><h4 id="edited-code">Edited Code</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;홍길동&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">birthday</span><span class="o">:</span> <span class="s2">&#34;030219&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">age</span><span class="o">:</span> <span class="mi">30</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">pId</span><span class="o">:</span> <span class="s2">&#34;1234567&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fullId</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">birthday</span> <span class="o">+</span> <span class="nx">pId</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></div><p>위 코드에 따라 <code>person</code> 객체 안에 있는 <code>fullID</code> 함수를 아래처럼 호출하면 <code>ReferenceError</code>가 발생된다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">person</span><span class="p">.</span><span class="nx">fullId</span><span class="p">();</span>
</span></span></code></pre></div><p>RESULT</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">C:<span class="se">\U</span>sers<span class="se">\E</span>unice<span class="se">\O</span>neDrive - Sogang<span class="se">\바</span>탕 화면<span class="se">\g</span>it<span class="se">\a</span>i_webdev<span class="se">\j</span>s_ts<span class="se">\t</span>his_reference_error<span class="se">\8</span>_object.js:7
</span></span><span class="line"><span class="cl">        <span class="k">return</span> birthday + pId<span class="p">;</span>
</span></span><span class="line"><span class="cl">        ^
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ReferenceError: birthday is not defined
</span></span><span class="line"><span class="cl">    at Object.fullId <span class="o">(</span>C:<span class="se">\U</span>sers<span class="se">\E</span>unice<span class="se">\O</span>neDrive - Sogang<span class="se">\바</span>탕 화면<span class="se">\g</span>it<span class="se">\a</span>i_webdev<span class="se">\j</span>s_ts<span class="se">\t</span>his_reference_error<span class="se">\8</span>_object.js:7:9<span class="o">)</span>
</span></span><span class="line"><span class="cl">    at Object.&lt;anonymous&gt; <span class="o">(</span>C:<span class="se">\U</span>sers<span class="se">\E</span>unice<span class="se">\O</span>neDrive - Sogang<span class="se">\바</span>탕 화면<span class="se">\g</span>it<span class="se">\a</span>i_webdev<span class="se">\j</span>s_ts<span class="se">\t</span>his_reference_error<span class="se">\8</span>_object.js:10:8<span class="o">)</span>
</span></span><span class="line"><span class="cl">    at Module._compile <span class="o">(</span>node:internal/modules/cjs/loader:1254:14<span class="o">)</span>
</span></span><span class="line"><span class="cl">    at Module._extensions..js <span class="o">(</span>node:internal/modules/cjs/loader:1308:10<span class="o">)</span>
</span></span><span class="line"><span class="cl">    at Module.load <span class="o">(</span>node:internal/modules/cjs/loader:1117:32<span class="o">)</span>
</span></span><span class="line"><span class="cl">    at Module._load <span class="o">(</span>node:internal/modules/cjs/loader:958:12<span class="o">)</span>
</span></span><span class="line"><span class="cl">    at Function.executeUserEntryPoint <span class="o">[</span>as runMain<span class="o">]</span> <span class="o">(</span>node:internal/modules/run_main:81:12<span class="o">)</span>
</span></span><span class="line"><span class="cl">    at node:internal/main/run_main_module:23:47
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Node.js v18.15.0
</span></span></code></pre></div><p>단, 아래와 같이 함수를 호출하면 정상 결과가 나타난다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">person</span><span class="p">.</span><span class="nx">fullId</span><span class="p">;</span>
</span></span></code></pre></div><p>RESULT</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">올해는 2023년입니다.
</span></span></code></pre></div><hr>
<h4 id="설명">설명</h4>
<p>ReferenceError 발생 원인</p>
<ul>
<li>객체는 현재 범위에서 존재하지 않거나 (non-existing),</li>
<li>초기화되지 않은 (not initialized) 변수를 참조했을 때 발생하는 에러</li>
</ul>
<p>this</p>
<ul>
<li>객체 내부에서 사용될 때 현재 해당 객체(current object)를 가리킨다</li>
</ul>
<p>코드 안에서 this는 person 객체 안에서 사용되었으니
<code>this</code>는 <code>person</code>을 참조하게 된다.
&ndash;&gt;  this.birthday는 person의 birthday 속성을을 가리킨다.</p>
<h5 id="괄호-를-사용하여-fullid-함수-호출">괄호 &lsquo;()&lsquo;를 사용하여 <code>fullId</code> 함수 호출</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">person</span><span class="p">.</span><span class="nx">fullId</span><span class="p">()</span>
</span></span></code></pre></div><ul>
<li>위 방식대로 <code>fullID</code> 함수를 호출하면 이 함수가 person 객체의 함수로 호출된다.</li>
<li>원래 코드에서 <code>return this.birthday + this.pId</code> 를 쓰면 <code>this</code>는 <code>person</code> 객체를 가리키고, <code>this.birthday</code> 와 <code>this.pId</code>는 <code>person</code>의 <code>birthday</code>와 <code>pID</code> 프로포티를 가리킨다.</li>
<li>이 경우 <code>return birthday + pId</code>와 같이 <code>this.</code> 를 안 붙이고 접근을 시도하면 JS 인터프리터는 <code>birthday</code>와 <code>pId</code> 를 <code>person</code> 객체의 property가 아닌 <code>fullId</code>  함수 안에 정의된 변수들이라고 가정할 것이다. <code>fullId</code> 안에서 <code>birthday</code>와 <code>pId</code> 라는 변수가 선언되지 않았으니 정의가 없으며<code>undefined</code> 가 된다. 이 때문에 <code>ReferenceError</code>가 발생된다.
<ul>
<li>자바스크립트에서 <code>this.</code>를 붙여서 범위(scope) 또는 문맥(context)를 알려주지 않으면 인터프리터는 현재 범위(current scope)부터 상위 범위(parent scope), 그리고 전역 범위(global scope)까지 탐색하여 해당 변수를 찾는다. (<code>fullId</code> 함수는 <code>person</code> 객체 범위 안에 있으니 <code>fullId</code>의 현재 범위는 함수 안의 범위이고 상위 범위는 전역 범위(global)이다. <code>birthday</code> 와 <code>pId</code>는 함수 안에 그리고 전역적으로 정의되어 있지 않기 때문에 인터프리터가 변수들을 찾지 못하는 상황이 되며 ReferenceError의 원인이 된다.)</li>
</ul>
</li>
</ul>
<p>따라서 <code>person.fullId()</code>로 호출할 때 <code>this.birthday</code>와  <code>this.pId</code>를 사용해야 <code>person</code> 객체의 property를 참조하면 <code>ReferenceError</code> 가 발생하지 않는다.</p>
<h5 id="괄호--없이-fullid-함수-호출">괄호 &lsquo;()&rsquo; 없이 <code>fullId</code> 함수 호출</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">person</span><span class="p">.</span><span class="nx">fullId</span><span class="p">;</span>
</span></span></code></pre></div><ul>
<li>위 방식의 경우 <code>person.fullId</code>는 함수를 호출 또는 실행시키지 않고 참조만 하는 방식이다.</li>
<li>함수를 호출하지 않고 참조만 하기 때문에 함수의 문맥(context) 즉 this의 값이 중요하지 않다. 따라서 <code>fullId</code> 함수 안에서 <code>birthday</code> 와 <code>pId</code> 속성에 접근하려는 시도를 하지 않으며, <code>return birthday + pId</code>를 사용해도 ReferenceError가 발생하지 않는다.</li>
</ul>
<hr>
<h4 id="요약">요약</h4>
<p><code>person.fullId();</code></p>
<ul>
<li>person 객체의 메서드로서 함수를 호출한다.</li>
<li><code>fullId</code> 함수 내부의 <code>this</code> 키워드는 <code>person</code> 객체를 가리키며, <code>this.birthday</code>와 <code>this.pId</code>에 접근할 수 있다.</li>
</ul>
<p><code>person.fullId;</code></p>
<ul>
<li>함수 자체를 반환하며 호출하지 않는다.</li>
<li>함수는 참조만 되고 실행되지 않기 때문에 오류가 발생하지 않는다.</li>
</ul>
<br>
<h4 id="source-code">SOURCE CODE</h4>
<p><a href="https://github.com/ganyunhee/ai_webdev/tree/main/js_ts/this_reference_error">https://github.com/ganyunhee/ai_webdev/tree/main/js_ts/this_reference_error</a></p>
<hr>
<br>
<h1 id="과제--오목게임-day-7-continuation">과제 &gt; 오목게임 (Day 7 continuation)</h1>
<ul>
<li>기능 추가 : 승패가 계속 나지 않을 경우 실행 후 5분이 지나면 자동 종료시킨다.</li>
</ul>
<br>
<h3 id="issue-player-1-always-wins-output-typo">ISSUE. Player 1 always wins (output typo)</h3>
<p>I noticed that the program always prints out that Player 1 wins even when Player 2 wins&hellip;
And then I found a typo in the output. Whoops!</p>
<p>Before changes:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">console.log(`GAME OVER. Player ${currentPlayer === 1 ? &#39;1&#39; : &#39;1&#39;} wins!`);
</span></span></code></pre></div><p>After changes:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">console.log(`GAME OVER. Player ${currentPlayer === 1 ? &#39;1&#39; : &#39;2&#39;} wins!`);
</span></span></code></pre></div><br>
<h3 id="current-code">Current Code</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">let board: string[][] = [];
</span></span><span class="line"><span class="cl">var row = 0;
</span></span><span class="line"><span class="cl">var col = 0;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// FUNCTION. initialize 30x30 board with &#39;-&#39;
</span></span><span class="line"><span class="cl">function init() {
</span></span><span class="line"><span class="cl">    // traverse rows
</span></span><span class="line"><span class="cl">    for (let i=0; i &lt; 30; i++) {
</span></span><span class="line"><span class="cl">        const row: string[] = [];
</span></span><span class="line"><span class="cl">        // traverse columns
</span></span><span class="line"><span class="cl">        for (let j=0; j &lt; 30; j++) {    
</span></span><span class="line"><span class="cl">            row.push(&#39;-&#39;);
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">        board.push(row);
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// FUNCTION. print out board contents
</span></span><span class="line"><span class="cl">function output() {
</span></span><span class="line"><span class="cl">    for (const row of board) {
</span></span><span class="line"><span class="cl">        console.log(row.join(&#39; &#39;));
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// FUNCTION. update the board
</span></span><span class="line"><span class="cl">// -- based on player input
</span></span><span class="line"><span class="cl">function update(row: number, col: number, player: number) {
</span></span><span class="line"><span class="cl">    if(board[row][col] === &#39;-&#39;) {
</span></span><span class="line"><span class="cl">        board[row][col] = player === 1 ? &#39;B&#39; : &#39;W&#39;;
</span></span><span class="line"><span class="cl">        return true;
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    return false;
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// FUNCTION. get user input (continuous)
</span></span><span class="line"><span class="cl">async function getPlayerInput(player: number) {
</span></span><span class="line"><span class="cl">    // import readline module
</span></span><span class="line"><span class="cl">    const rl = require(&#39;readline&#39;).createInterface ({
</span></span><span class="line"><span class="cl">        input: process.stdin,
</span></span><span class="line"><span class="cl">        output: process.stdout
</span></span><span class="line"><span class="cl">    });
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    // read and return user input
</span></span><span class="line"><span class="cl">    return new Promise&lt;string&gt;((resolve) =&gt; {
</span></span><span class="line"><span class="cl">        rl.question(`Player ${player}&#39;s turn (row col): `, (response) =&gt; {
</span></span><span class="line"><span class="cl">            rl.close();
</span></span><span class="line"><span class="cl">            resolve(response);
</span></span><span class="line"><span class="cl">        });
</span></span><span class="line"><span class="cl">    });
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// FUNCTION. Check if player wins
</span></span><span class="line"><span class="cl">// -- win condition logic :
</span></span><span class="line"><span class="cl">// -- check if any row, column, diagonal has five matching symbols
</span></span><span class="line"><span class="cl">function checkWinCondition(): boolean {
</span></span><span class="line"><span class="cl">    // check rows
</span></span><span class="line"><span class="cl">    for (let i = 0; i &lt; 30; i++) {
</span></span><span class="line"><span class="cl">        let countB = 0;
</span></span><span class="line"><span class="cl">        let countW = 0;
</span></span><span class="line"><span class="cl">        for (let j = 0; j &lt; 30; j++) {
</span></span><span class="line"><span class="cl">            if (board[i][j] === &#39;B&#39;) {
</span></span><span class="line"><span class="cl">                countB++;
</span></span><span class="line"><span class="cl">                countW = 0;
</span></span><span class="line"><span class="cl">            } else if (board[i][j] === &#39;W&#39;) {
</span></span><span class="line"><span class="cl">                countW++;
</span></span><span class="line"><span class="cl">                countB = 0;
</span></span><span class="line"><span class="cl">            } else {
</span></span><span class="line"><span class="cl">                countB = 0;
</span></span><span class="line"><span class="cl">                countW = 0;
</span></span><span class="line"><span class="cl">            }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            if (countB === 5 || countW === 5) {
</span></span><span class="line"><span class="cl">                return true;
</span></span><span class="line"><span class="cl">            }
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    // check columns
</span></span><span class="line"><span class="cl">    for (let j = 0; j &lt; 30; j++) {
</span></span><span class="line"><span class="cl">            let countB = 0;
</span></span><span class="line"><span class="cl">            let countW = 0;
</span></span><span class="line"><span class="cl">            for (let i = 0; i &lt; 30; i++) {
</span></span><span class="line"><span class="cl">            if (board[i][j] === &#39;B&#39;) {
</span></span><span class="line"><span class="cl">                countB++;
</span></span><span class="line"><span class="cl">                countW = 0;
</span></span><span class="line"><span class="cl">            } else if (board[i][j] === &#39;W&#39;) {
</span></span><span class="line"><span class="cl">                countW++;
</span></span><span class="line"><span class="cl">                countB = 0;
</span></span><span class="line"><span class="cl">            } else {
</span></span><span class="line"><span class="cl">                countB = 0;
</span></span><span class="line"><span class="cl">                countW = 0;
</span></span><span class="line"><span class="cl">            }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            if (countB === 5 || countW === 5) {
</span></span><span class="line"><span class="cl">                return true;
</span></span><span class="line"><span class="cl">            }
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    // check diagonals
</span></span><span class="line"><span class="cl">    for (let i = 0; i &lt; 30; i++) {
</span></span><span class="line"><span class="cl">        for (let j = 0; j &lt; 30; j++) {
</span></span><span class="line"><span class="cl">            // check diagonals
</span></span><span class="line"><span class="cl">            // start from (i, j) going right and down
</span></span><span class="line"><span class="cl">            let countB = 0;
</span></span><span class="line"><span class="cl">            let countW = 0;
</span></span><span class="line"><span class="cl">            for (let k = 0; k &lt; 5; k++) {
</span></span><span class="line"><span class="cl">                if (i + k &lt; 30 &amp;&amp; j + k &lt; 30) {
</span></span><span class="line"><span class="cl">                    if (board[i + k][j + k] === &#39;B&#39;) {
</span></span><span class="line"><span class="cl">                        countB++;
</span></span><span class="line"><span class="cl">                        countW = 0;
</span></span><span class="line"><span class="cl">                    } else if (board[i + k][j + k] === &#39;W&#39;) {
</span></span><span class="line"><span class="cl">                        countW++;
</span></span><span class="line"><span class="cl">                        countB = 0;
</span></span><span class="line"><span class="cl">                    } else {
</span></span><span class="line"><span class="cl">                        countB = 0;
</span></span><span class="line"><span class="cl">                        countW = 0;
</span></span><span class="line"><span class="cl">                    }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    if (countB === 5 || countW === 5) {
</span></span><span class="line"><span class="cl">                        return true;
</span></span><span class="line"><span class="cl">                    }
</span></span><span class="line"><span class="cl">                }
</span></span><span class="line"><span class="cl">            }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            // Check diagonals starting from position (i, j) going right and up
</span></span><span class="line"><span class="cl">            countB = 0;
</span></span><span class="line"><span class="cl">            countW = 0;
</span></span><span class="line"><span class="cl">                for (let k = 0; k &lt; 5; k++) {
</span></span><span class="line"><span class="cl">                    if (i - k &gt;= 0 &amp;&amp; j + k &lt; 30) {
</span></span><span class="line"><span class="cl">                        if (board[i - k][j + k] === &#39;B&#39;) {
</span></span><span class="line"><span class="cl">                            countB++;
</span></span><span class="line"><span class="cl">                            countW = 0;
</span></span><span class="line"><span class="cl">                        } else if (board[i - k][j + k] === &#39;W&#39;) {
</span></span><span class="line"><span class="cl">                            countW++;
</span></span><span class="line"><span class="cl">                            countB = 0;
</span></span><span class="line"><span class="cl">                        } else {
</span></span><span class="line"><span class="cl">                            countB = 0;
</span></span><span class="line"><span class="cl">                            countW = 0;
</span></span><span class="line"><span class="cl">                        }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                        if (countB === 5 || countW === 5) {
</span></span><span class="line"><span class="cl">                            return true;
</span></span><span class="line"><span class="cl">                        }
</span></span><span class="line"><span class="cl">                    }
</span></span><span class="line"><span class="cl">                }
</span></span><span class="line"><span class="cl">            }
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    return false;
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// FUNCTION. play
</span></span><span class="line"><span class="cl">// -- continuosly prompt to get user input and check for winner
</span></span><span class="line"><span class="cl">async function playGame() {
</span></span><span class="line"><span class="cl">    // initialize
</span></span><span class="line"><span class="cl">    init();
</span></span><span class="line"><span class="cl">    let currentPlayer = 1;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    // check for win
</span></span><span class="line"><span class="cl">    while (!checkWinCondition()) {
</span></span><span class="line"><span class="cl">        // print board
</span></span><span class="line"><span class="cl">        output();
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        // await user input
</span></span><span class="line"><span class="cl">        const input = await getPlayerInput(currentPlayer);
</span></span><span class="line"><span class="cl">        const [row, col] = input.split(&#39; &#39;).map((coord) =&gt; parseInt(coord));
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        // check for valid moves
</span></span><span class="line"><span class="cl">        if (row &gt;= 0 &amp;&amp; row &lt; 30 &amp;&amp; col &gt;= 0 &amp;&amp; col &lt; 30) {
</span></span><span class="line"><span class="cl">            const validMove = update(row, col, currentPlayer);
</span></span><span class="line"><span class="cl">            if (validMove) {
</span></span><span class="line"><span class="cl">                currentPlayer = currentPlayer === 1 ? 2 : 1;
</span></span><span class="line"><span class="cl">            } else {
</span></span><span class="line"><span class="cl">                console.log(&#39;Invalid move. Try again.&#39;);
</span></span><span class="line"><span class="cl">            }
</span></span><span class="line"><span class="cl">        } else {
</span></span><span class="line"><span class="cl">            console.log(&#39;Invalid input. Try again.&#39;);
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    // end game
</span></span><span class="line"><span class="cl">    output();
</span></span><span class="line"><span class="cl">    console.log(`GAME OVER. Player ${currentPlayer === 1 ? &#39;1&#39; : &#39;2&#39;} wins!`);
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// run game
</span></span><span class="line"><span class="cl">// -- if error persists, print error
</span></span><span class="line"><span class="cl">playGame().catch((error) =&gt; console.error(error));
</span></span></code></pre></div><h3 id="step-6-add-timer">Step 6. Add Timer</h3>
<h3 id="add-flags">Add flags</h3>
<p>Inside the <code>playGame()</code> async function,</p>
<p>Add flag to track if the game is won</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">isGameWon</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span></code></pre></div><p>Add flag to track if timeout is reached</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">isTimeout</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span></code></pre></div><h3 id="add-functions-to-set-flags">Add functions to set flags</h3>
<p>Inside the <code>playGame()</code> async function,</p>
<p>Add function to check for win condition and change flag if there is a winner.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">checkAndSetGameWon() {</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="nx">checkWinCondition</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">isGameWon</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Add function to change timeout flag.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">handleTimeout() {</span>
</span></span><span class="line"><span class="cl">	<span class="nx">isTimeout</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">output</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;DRAW. Five minutes have passed. No player has won.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="add-timer-via-settimeout">Add timer via <code>setTimeout()</code></h3>
<p>To add a timer, I used the JavaScript function <code>setTimeout()</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="nx">setTimeout</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="nx">delay</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">//OR
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">setTimeout</span><span class="p">(</span><span class="nx">functionRef</span><span class="p">,</span> <span class="nx">delay</span><span class="p">)</span>
</span></span></code></pre></div><p><code>setTimeout()</code></p>
<ul>
<li>sets a timer, then executes a function or code after timer expires
ref. <a href="https://developer.mozilla.org/en-US/docs/Web/API/setTimeout">https://developer.mozilla.org/en-US/docs/Web/API/setTimeout</a></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="nx">setTimeout</span><span class="p">(</span><span class="nx">handleTimeout</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">);</span>
</span></span></code></pre></div><p>Here, the timer is set to five minutes converted into milliseconds
5 * 60 to convert minutes to seconds, then
(5 * 60) * 1000 to convert seconds to milliseconds
After the delay, <code>setTimeout()</code> then calls <code>handleTimeout()</code>.</p>
<p>NOTE. This timer does not restart after every user input and counts five minutes for the entirety of game. In short, players can play only until five minutes.</p>
<h3 id="change-conditions-for-pre-existing-while-loop">Change conditions for pre-existing <code>while</code> loop</h3>
<p>To make the game loop until the game is won, I called the <code>checkWinCondition()</code> throughout the <code>while</code> loop in my previous code. I now need to loop until the game is won or until the timer expires.</p>
<p>Since I&rsquo;ve made the <code>checkAndSetGameWon()</code> function to check if the player wins by calling <code>checkWinCondition()</code> and setting the <code>isGameWon</code> flag that indicates if a player wins, I will only need to check the flag in the <code>while</code> loop.</p>
<p>This goes the same for the timeout flag. And so we have the following conditions for the <code>while</code> loop.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="nx">isGameWon</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isTimeout</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Since I now have a separate function that checks the game status and sets the win flag, I have to call it for every valid move a player makes in order to check if the player is making a move that wins the game.</p>
<p>So I modified the conditions for checking valid moves as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">row</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">row</span> <span class="o">&lt;</span> <span class="mi">30</span> <span class="o">&amp;&amp;</span> <span class="nx">col</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">col</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kr">const</span> <span class="nx">validMove</span> <span class="o">=</span> <span class="nx">update</span><span class="p">(</span><span class="nx">row</span><span class="p">,</span> <span class="nx">col</span><span class="p">,</span> <span class="nx">currentPlayer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="nx">validMove</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">currentPlayer</span> <span class="o">=</span> <span class="nx">currentPlayer</span> <span class="o">===</span> <span class="mi">1</span> <span class="o">?</span> <span class="nx">2</span> : <span class="kt">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nx">checkAndSetGameWon</span><span class="p">();</span> <span class="c1">// check if player makes a winning move
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Invalid move. Try again.&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Invalid input. Try again.&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="issue-continuous-timer-even-after-the-game-has-ended">ISSUE. Continuous timer even after the game has ended</h2>
<p>The timer kept counting for five minutes even after a player has won, and when the timer expires, it prints out a message resulting to the following.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">GAME OVER. Player 1 wins!
</span></span><span class="line"><span class="cl">DRAW. Five minutes have passed. No player has won.
</span></span></code></pre></div><p>I found a JavaScript function that can clear the timeout to prevent <code>handleTimeout()</code> from executing after game ends.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">timeoutID</span><span class="p">)</span>
</span></span></code></pre></div><p><code>clearTimeout()</code></p>
<ul>
<li>cancels a timeout previously established by <code>setTimeout()</code>
ref. <a href="https://developer.mozilla.org/en-US/docs/Web/API/clearTimeout">https://developer.mozilla.org/en-US/docs/Web/API/clearTimeout</a></li>
</ul>
<p>So I used the <code>setTimeout()</code> function as an object and put it into a constant variable named <code>timeout</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">timeout</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">handleTimeout</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">);</span>
</span></span></code></pre></div><p>Then cleared that timeout just before printing the last changes to the board (after a player&rsquo;s winning turn) and ending the game with a &ldquo;Player # wins&rdquo; message.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">timeout</span><span class="p">);</span>
</span></span></code></pre></div><p>RESULT</p>
<p><img src="/posts/posts_images/aiweb_day8/output1.png" alt=""></p>
<h3 id="issue-game-does-not-end-even-after-timer-expires">ISSUE. Game does not end even after timer expires</h3>
<p>The program asks for one last input and considers valid input as an invalid move before ending the game.</p>
<p><img src="/posts/posts_images/aiweb_day8/output2.png" alt=""></p>
<p>I added <code>return</code> at the end of the <code>handleTimeout()</code> function in order for it to end the <code>playGame()</code> function after the timer expires.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">handleTimeout() {</span>
</span></span><span class="line"><span class="cl">	<span class="nx">isTimeout</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">output</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;DRAW. Five minutes have passed. No player has won.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>RESULT</p>
<p><img src="/posts/posts_images/aiweb_day8/output3.png" alt=""></p>
<br>
<h4 id="source-code-1">SOURCE CODE</h4>
<p><a href="https://github.com/ganyunhee/ai_webdev/tree/main/js_ts/omok_game">https://github.com/ganyunhee/ai_webdev/tree/main/js_ts/omok_game</a></p>
<hr>
<p><br><br><br><br></p>
<h4 id="heading">——————————————————————————</h4>
<p>본 후기는 정보통신산업진흥원(NIPA)에서 주관하는 &lt;AI 서비스 완성! AI+웹개발 취업캠프 - 프론트엔드&amp;백엔드&gt; 과정 학습/프로젝트/과제 기록으로 작성 되었습니다.
#정보통신산업진흥원 #NIPA #AI교육 #프로젝트 #유데미 #IT개발캠프 #개발자부트캠프 #프론트엔드 #백엔드 #AI웹개발취업캠프 #취업캠프 #개발취업캠프</p>

    </div>
  </div>

    <div class="footer">
  
  <div class="footer-social">
    
      <span class="social-icon social-icon-github">
        <a href="https://github.com/ganyunhee/" title="github" target="_blank" rel="noopener">
          <img src="/images/social/github.svg" width="24" height="24" alt="github"/>
        </a>
      </span>
    
      <span class="social-icon social-icon-linkedin">
        <a href="https://www.linkedin.com/in/eunice-gan/" title="linkedin" target="_blank" rel="noopener">
          <img src="/images/social/linkedin.svg" width="24" height="24" alt="linkedin"/>
        </a>
      </span>
    
  </div>
  
</div>
  </div>

  

  
    <script type="text/javascript" src="/js/bundle.min.5993fcb11c07dea925a3fbd58c03c7f1857197c35fccce3aa963a12c0b3c9960.js"></script>
  

  
  

  
  
  
    
  

  

  

</body>
</html>